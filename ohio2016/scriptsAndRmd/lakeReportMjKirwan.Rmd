---
title: "Water Quality and Methane Emissions at M.J. Kirwan Reservoir, Ohio"
author: "J. Beaulieu and S. Waldo"
date: "May 5, 2017"
output: 
  pdf_document:
    includes: 
      in_header: header.tex
---
## 1. Background:

The US Environmental Protection Agency (USEPA) is conducting an investigation of methane (CH~4~) dynamics in reservoirs. CH~4~ is a potent greenhouse gas that is produced by microorganisms in reservoir sediments. The objective is to estimate the magnitude of CH~4~ emissions from reservoirs in the United States. 

The USEPA measured CH~4~ emissions from 32 reservoirs in Ohio, Indiana, and Kentucky during the summer of 2016. We designated a minimum of 15 sampling sites in each reservoir (depending on reservoir size), where we measured CH~4~ emissions and several water quality indicators. CH~4~ emissions were measured using a device which captures CH~4~-rich bubbles as they rise through the water column toward the atmosphere. A sonde was used to measure chlorophyll a, dissolved oxygen, pH, specific conductivity, water temperature, and turbidity just below the water surface at each of the 15 sites. Additionally, nutrient chemistry was analyzed at one shallow and one deep site for each reservoir.  

This preliminary report presents results from the USEPA 2016 measurement campaign relevant to MJ Kirwan reservoir, a US Army Corps of Engineers reservoir in eastern Ohio. These data will be included in a formal peer-reviewed publication to be submitted for publication in early 2018.  This preliminary report includes:  

1. This background information
2. A map showing the location of the sampled sites
3. A 3D map of the reservoir showing the measurement results for :
    + CH~4~ emissions
    + Chlorophyll a
4. Figures showing how MJ Kirwan reservoir compared to the other 31 reservoirs in the study in terms of:
    + CH~4~ emissions
    + Total phosphorus 
    + Total nitrogen
    + Chlorophyll a
5. Tables summarizing the other measured water quality values at each site within MJ Kirwan reservoir   
 
Thank you for your help in including MJ Kirwan reservoir in this project. 



```{r setup, results='hide', message=FALSE, warning=FALSE, echo=FALSE}
#myWd <- "C:/Users/JBEAULIE/GitRepository/mulitResSurvey" # for Jake
myWd <- "C:/R_Projects/mulitResSurvey" # for Sarah

globalWd <- "L:/Priv/Cin/NRMRL/ReservoirEbullitionStudy/multiResSurvey2016/grtsDesign/"
```


```{r results='hide', message=FALSE, warning=FALSE, echo=FALSE}
#Get the data and libraries

# knit() creates a new session and therefore can't read objects directly from
# workspace.  Run this file outside of project session and load project
# workspace.

load(paste(myWd, "/.RData", sep = ""))

library(ggplot2)
library(ggmap)
library(ggrepel)
library(dplyr)
library(knitr)
library(rgdal)
library(rgeos)
```

\newpage



## 2. Map of Sampled Sites    
MJ Kirwan reservoir, located in eastern Ohio, is one of 16 flood control and multipurpose reservoirs managed by the US Army Corps of Engineers in the Pittsburg District.  We sampled MJ Kirwan reservoir on September 6^th^ - 7^th^ of 2016. The sampling sites were chosen using a generalized random tessellation stratified design ("GRTS"), an approach which combines elements of systematic and random survey designs which allows for the random allocation of sampling sites with maximum  spatial coverage of the reservoir. We used a GPS and geographic information system (GIS) software to locate each sampling site (+/- 30 meters).  Chlorophyll a, dissolved oxygen, pH, specific conductivity, water temperature, turbidity, and CH~4~ emissions were measured at all sampling sites.  Nutrient concentrations were measured at one deep site near the dam and one shallow site near the inflow.   

```{r results='hide', message=FALSE, warning=FALSE, echo=FALSE, fig.width=7, fig.height=6.4, fig.cap='*Location of the fifteen sample sites within MJ Kirwan reservoir, located in eastern Ohio. Water samples for nutrient analysis were collected from one deep and one shallow site. Satellite image from Google Maps.*'}


# Read and project spatial points dataframe for plotting
mjKirwanSitesPlot <- readOGR(dsn = paste(globalWd, "mjKirwan", sep=""), 
                          layer = "mjKirwanSitesEqAreaData")  # shapefile with data

mjKirwanSites84 <- spTransform(x = mjKirwanSitesPlot, #reproject
                            CRS("+proj=longlat +datum=WGS84")) # projection for google maps

mjKirwanSites84@data <- mutate(mjKirwanSites84@data, 
                            long=coordinates(mjKirwanSites84)[,1], # add long to @data slot
                            lat=coordinates(mjKirwanSites84)[,2]) # add lat to @data slot

# Specify chemistry sampling sites
mjKirwanSites84@data <- mutate(mjKirwanSites84@data,
                              chem = ifelse(siteID %in% c("S-04", "S-23"), 
                                  "chem",
                                  "no_chem"))

# Get ggmap
bbox <- make_bbox(data=mjKirwanSites84@data, #defines map extent based on sample site lat/lon
                  long, lat, f = 0.8) # f is zoom.  Large #, less zoom. tweak for each lake.  
mjKirwanSat <- get_map(location = bbox,
                    color = "color",
                    source = "google",
                    maptype = "satellite")

ggmap(mjKirwanSat) +
  ylab("Latitude") +
  xlab ("Longitude") +
  geom_point(data=filter(mjKirwanSites84@data, EvalStatus == "sampled"), #only main sites
             aes(x=long, y=lat, color = chem),
             size = 2) + 
  theme(plot.title = element_text(hjust = 0.5)) +  #plot title justify center
  geom_text_repel(data=filter(mjKirwanSites84@data, EvalStatus == "sampled"), #only main sites
            aes(label=siteID, x=long, y=lat, color = chem),
            size=3) +      #alternate color: "#F8766D"
    scale_color_manual(values = c("yellow", "white"), #alternate color: "#F8766D" "#00BFC4"
                     labels = c("Nutrient sample",
                                "No nutrient sample")) +
  guides(color = guide_legend(title = NULL)) +
  coord_equal() +
  ggtitle("MJ Kirwan Reservoir Sample Sites")
```



\newpage


## 3.  Within-lake values of methane emissions and chlorophyll a concentrations  

Previous studies have found a general pattern of higher CH~4~ emissions in the river-reservoir transition (tributary) area, and lower emissions in the deeper downstream waters. The MJ Kirwan reservoir in eastern Ohio displayed this pattern: the highest emissions were observed in the upper half of the reservoir nearest the inflow.

```{r echo=FALSE, warning=F, message=F, error=F, fig.width=7, fig.height=7, fig.cap='*Methane emissions measured at the 15 sample sites within MJ Kirwan reservoir from September 6^th^ to 7^th^, 2016. The height of each "lollipop" corresponds to the emission rate shown on the vertical z-axis in units of milligrams CH~4~ per square meter of lake surface per hour.*' }


mjKirwanEqArea84 <- readOGR(dsn = paste(globalWd, "mjKirwan", sep=""), # get polygon
                           layer = "mjKirwanEqArea84",  # shapefile name
                            verbose = FALSE)  #keep from reporting progress

# Dissolve strata from polygon
mjKirwanEqArea84 <- gUnaryUnion(mjKirwanEqArea84, id = mjKirwanEqArea84@data$GNIS_Name)

mjKirwanSites84@data <- merge(mjKirwanSites84@data, # add emission to point shp
                             filter(eqAreaData, Lake_Name == "Michael J Kirwan Reservoir") %>%
                               select(ch4.trate.mg.h, siteID))

# load external script (this is the scatterplot3d function, but changed a bit with to add more user control over style)
source(paste(myWd, "/ohio2016/scriptsAndRmd/scatterplot3d_edit.R", sep = ""))

# grab coordinates from polygon (in order to plot as a line on the xy plane of 3D plot)
coords = fortify(mjKirwanEqArea84)
coords <- subset(coords, !hole)



##########################################################################
### Total CH4 emission rate
with(mjKirwanSites84@data, {
  ch4_plot <- scatterplot3d_edit(x=coords$long, y=coords$lat, z=rep(0,length(coords$long)),   # x y and z data, respectively
                                   color="#282830",                               # color of lake outline
                                   lwd=2.0,                                       # line width of lake outline
                                   type="l",                                      # plot type - "l" = line, "h" = the lollipop style with a line  connecting to the horizontal plane 
                                   fill = "white",
                                   angle=40,                                      # angle aspect of plot
                                   scale.y=0.5,                                   # scale y axis (increase by 175% (1.75))
                                   xlab="Latitude",                               # x-axis label (left blank here to reposition later)
                                   ylab="",                                       # y-axis label
                                   y.margin.add = 0.5,
                                   cex.axis = 0.7, 
                                   cex.lab = 1.1,
                                   mar = c(5,6,4,2)+0.1,
                                   zlab=expression(CH[4]~emission~rate~(mg~ CH[4]~ m^{-2}~ hr^{-1})),                      # z-axis label
                                   zlim=range(0,15),                              # range of z data shown - I grabbed the max from previously plotting the methane data here. Set so when I add the points, the z-axis fits that data. 
                                   labs.line.z=-0.3,                              # adjustment of the z axis tick labels in margin lines
                                   n.breaks.x=7,                                  # Number of breaks for the axis. If x.pretty = TRUE, this is just a suggestion. It may do more or less. If left blank, defaults to par("lab")[1] value
                                   x.pretty=FALSE,                                # Whether or not to let the function create pretty breaks (default to TRUE if unspecified)
                                   x.sig=4,                                       # When x.pretty=FALSE, can use this to set the sig. digits displayed for x axis tick labels
                                   lty.axis=1,                                    # the line type of the axes
                                   axis=TRUE,                                     # wheather to include axes
                                   tick.marks = TRUE,
                                   label.tick.marks = TRUE,   #whether or not to include tick mark labels for all three axes
                                   x.ticklabs=NULL,
                                   y.ticklabs=NULL,
                                 
                                 grid=c('xy','xz','yz'),                          # which grids to show - added to edited version of scatterplot3d fx
                                   lty.grid.xy = 1,                               # grid line type  
                                   lty.grid.xz = 3,
                                   lty.grid.yz = 3,
                                   lwd.grid.xy = 1,                               # line width of grid 
                                   lwd.grid.xz = 1,
                                   lwd.grid.yz = 1,
                                   box=FALSE                                      # get rid of the box around the plot
                                    
                                 )
  
  # reposition & add y-axis label
  dims <- par("usr")                        # format of 'dims' is vector of: [xmin,xmax,ymin,ymax]
  x <- dims[2] - 0.03*diff(dims[1:2])       # define x position of label
  y <- dims[3] + 0.18*diff(dims[3:4])       # define y position of label
  text(x,y,"Longitude", srt=65)             # add label.  srt sets angle
  
    # add dam label
  dims <- par("usr")                        # format of 'dims' is vector of: [xmin,xmax,ymin,ymax]
  x.d <- dims[1] + 0.8*diff(dims[1:2])       # define x position of label
  y.d <- dims[3] + 0.28*diff(dims[3:4])        # define y position of label
  text(x.d, y.d, "Dam")             # add label.  srt sets angle
  
  # add inflow label
  dims <- par("usr")                        # format of 'dims' is vector of: [xmin,xmax,ymin,ymax]
  x.i <- dims[1] + 0.1*diff(dims[1:2])       # define x position of label
  y.i <- dims[3] + 0.08*diff(dims[3:4])        # define y position of label
  text(x.i, y.i, "Inflow")    

  
  # add the lollipop points
  ch4_plot$points3d(x=long, y=lat, z=as.numeric(as.character(ch4.trate.mg.h)), # x y and z data
                      col="#282830",                      # color of lines connecting points to lake outline
                      lwd=1.5,                            # line width of lines connecting points to lake outline
                      pch=21,                             # type of point to plot
                      bg="#FF0000",                       # fill color of points
                      type="h",                           # plot type = lines to the horizontal plane
                      cex=2 #(vRateBest/500) + 0.5          # scaling of point sizes - this will need to be adjusted for each variable
  )
})
```

\newpage

Chlorophyll a concentrations showed a similar trend of decreading values with increasing distance from the inflow.  This is likely because the inflow is the primary nutrient source to the epilimnion during the summer (Figure 5).  

```{r echo=FALSE, warning=F, message=F, error=F, fig.width=7, fig.height=7, fig.cap='*Chlorophyll a concentrations measured at the 15 sample sites within MJ Kirwan reservoir on September 6^th^, 2016. The height of each "lollipop" corresponds to the concentration shown on the vertical z-axis in units of micrograms per liter of water.*' }
##########################################################################
### chlorophyll plot
with(mjKirwanSites84@data, {
  chl_plot <- scatterplot3d_edit(x=coords$long, y=coords$lat, z=rep(0,length(coords$long)),   # x y and z data, respectively
                                   color="#282830",                               # color of lake outline
                                   fill = "white",
                                   lwd=2.0,                                       # line width of lake outline
                                   type="l",                                      # plot type - "l" = line, "h" = the lollipop style with a line  connecting to the horizontal plane 
                                   angle=40,                                      # angle aspect of plot (-40)
                                   scale.y=0.5,                                   # scale y axis (increase by 175% (1.75)) 
                                   y.margin.add = 0.5,
                                   xlab="Latitude",                                       # x-axis label (left blank here to reposition later)
                                   ylab="",                                       # y-axis label
                                   cex.axis = 0.7,
                                   cex.lab = 1.1,
                                   mar = c(5,6,4,2)+0.1,
                                   zlab=(expression(chlorophyll~a~paste("(", {mu}, "g ", L^{-1}, ")", sep = ""))),                      # z-axis label
                                   zlim=range(0, 15),                            # range of z data shown - I grabbed the max from previously plotting the methane data here. Set so when I add the points, the z-axis fits that data. 
                                   labs.line.z=-0.3,                              # adjustment of the z axis tick labels in margin lines
                                   n.breaks.x=7,                                  # Number of breaks for the axis. If x.pretty = TRUE, this is just a suggestion. It may do more or less. If left blank, defaults to par("lab")[1] value
                                   x.pretty=FALSE,                                # Whether or not to let the function create pretty breaks (default to TRUE if unspecified)
                                   x.sig=4,                                       # When x.pretty=FALSE, can use this to set the sig. digits displayed for x axis tick labels
                                   lty.axis=1,                                    # the line type of the axes
                                   axis=TRUE,                                     # wheather to include axes
                                   grid=c('xy','xz','yz'),                        # which grids to show - added to edited version of scatterplot3d fx
                                   lty.grid.xy = 1,                               # grid line type  
                                   lty.grid.xz = 3,
                                   lty.grid.yz = 3,
                                   lwd.grid.xy = 1,                               # line width of grid 
                                   lwd.grid.xz = 1,
                                   lwd.grid.yz = 1,
                                   box=FALSE                                      # get rid of the box around the plot
  )
  
  # reposition & add y-axis label
  dims <- par("usr")                        # format of 'dims' is vector of: [xmin,xmax,ymin,ymax]
  x <- dims[2] - 0.03*diff(dims[1:2])       # define x position of label
  y <- dims[3] + 0.18*diff(dims[3:4])       # define y position of label
  text(x,y,"Longitude", srt=65)             # add label.  srt sets angle
  
    # add dam label
  dims <- par("usr")                        # format of 'dims' is vector of: [xmin,xmax,ymin,ymax]
  x.d <- dims[1] + 0.8*diff(dims[1:2])       # define x position of label
  y.d <- dims[3] + 0.28*diff(dims[3:4])        # define y position of label
  text(x.d, y.d, "Dam")             # add label.  srt sets angle
  
  # add inflow label
  dims <- par("usr")                        # format of 'dims' is vector of: [xmin,xmax,ymin,ymax]
  x.i <- dims[1] + 0.1*diff(dims[1:2])       # define x position of label
  y.i <- dims[3] + 0.08*diff(dims[3:4])        # define y position of label
  text(x.i, y.i, "Inflow")   
  
  # add the lollipop points
  chl_plot$points3d(x=long, y=lat, z=as.numeric(as.character(chla_S)), # x y and z data
                      col="#282830",                      # color of lines connecting points to lake outline
                      lwd=1.5,                            # line width of lines connecting points to lake outline
                      pch=21,                             # type of point to plot
                      bg="#FF0000",                       # fill color of points
                      type="h",                           # plot type = lines to the horizontal plane
                      cex=2 #(vRateBest/500) + 0.5          # scaling of point sizes - this will need to be adjusted for each variable
  )
})
```

\newpage

## 4. Comparative plots  

Chlorophyll a concentration and CH~4~ emission rate was measured at all sampling sites.  We used the measurements to calculate mean values and an uncertainty range for the reservoir. The uncertainty measure we used is the 95% confidence interval (CI), which is similar to two standard deviations (sd) from the mean in a normally distributed data set (where 2*sd = 95.45%). In the case of this study, the majority of the uncertainty is due to the spatial variability of a given parameter within the reservoir, rather than uncertainty due to analytical errors. 



```{r echo=FALSE, warning=FALSE, fig.width=7, fig.height=7, fig.cap='*Mean and 95% confidence interval (CI) of the CH~4~ emission rate for each reservoir in this study, calculated from the values measured at >=15 sites within each reservoir.*'  }
####################################################################################
### Item #4: Ordered dotplots of total CH4 emissions, DO, TP, TN, and chla

# Highlight MJ Kirwan reservoir (lake of interest) data with color
plotColor <- ifelse(meanVariance.c.lake.lu$Lake_Name == "Michael J Kirwan Reservoir",
                    "red", "black")

# CH4 total emission rate
# Reset plotting order for CH4 total emissions
# "orderLake" is a function defined in the masterLibrary.R script
meanVariance.c.lake.lu$fLake_Name <- orderLake(meanVariance.c.lake.lu, 
                                               choice1 = "ch4.t")
ggplot(meanVariance.c.lake.lu,
       aes(ch4.trate.mg.h_Estimate, fLake_Name)) +
  geom_point(color = plotColor) +
  geom_errorbarh(aes(xmax = ch4.trate.mg.h_UCB95Pct, 
                     xmin = ch4.trate.mg.h_LCB95Pct), 
                 color = plotColor) +
  xlab(expression(CH[4]~emission~rate~(mg~ CH[4]~ m^{-2}~ hr^{-1}))) +
  theme(axis.title.y = element_blank(), # Eliminate x-axis title
        plot.title = element_text(hjust = 0.5),  #plot title justify center
        axis.text.y = element_text(color = c(rep("black", 5), "red", rep("black", 26)),
        face = c(rep("plain", 5), "bold", rep("plain", 26)))) +
  ggtitle(expression(Mean~CH[4]~emission~rate~
                       paste("(", "95% CI", ")", sep = "")))
```


\newpage
Water samples for total phosphorus (TP) and total nitrogen (TN) were collected from just below the water surface at a shallow site near the inflow and a deep site near the dam.  The concentrations at both sites are shown below. 

```{r echo=FALSE, warning=FALSE, fig.width=7, fig.height=7, fig.cap='*TP concentrations at a deep and shallow site in each reservoir included in the study.  MJ Kirwan reservoir is highlighted in red.  See Fig. 1 for sample site locations.*'  }

# Chlorophyll 
meanVariance.c.lake.lu$fLake_Name <- orderLake(meanVariance.c.lake.lu, 
                                               choice1 = "chl")
ggplot(meanVariance.c.lake.lu,
       aes(chla_Estimate, fLake_Name)) +
  geom_point(color = plotColor) +
  geom_errorbarh(aes(xmax = chla_UCB95Pct, xmin = chla_LCB95Pct), color = plotColor) +
  xlab(expression(chlorophyll~a~paste("(", {mu}, "g ", L^{-1}, ")", sep = ""))) +
  theme(axis.title.y = element_blank(), # Eliminate x-axis title
        plot.title = element_text(hjust = 0.5),  #plot title justify center
        axis.text.y = element_text(color = c(rep("black", 4), "red", rep("black", 28)),
        face = c(rep("plain", 4), "bold", rep("plain", 28)))) +
  ggtitle("Mean Chlorophyll a (95% CI)")
```

\newpage

```{r echo=FALSE, warning=FALSE, fig.width=7, fig.height=7, fig.cap='*TP concentrations at a deep and shallow site in each reservoir included in the study.  MJ Kirwan reservoir is highlighted in red.  See Fig. 1 for sample site locations.*'  }

# TP 
# TP 
# Extract TP and TN data
tp.tn <- filter(eqAreaData, !is.na(TN)|!is.na(TP)) %>%
                  select(Lake_Name, siteID, TP, TN, wtrDpth, stratum)

# Create vector for deep or shallow site
tp.tn <- mutate(tp.tn, 
                d_s = ifelse(stratum == "trib",
                             "shallow",
                      ifelse(stratum == "open_water",
                                    "deep",
                      ifelse(stratum == "None" & Lake_Name == "Wingfoot Lake" & siteID == "U-16",
                                           "deep",
                      ifelse(stratum == "None" & Lake_Name == "Kiser Lake" & siteID == "U-12",
                                                  "deep",
                      ifelse(stratum == "None" & Lake_Name == "Hocking County Lake" & siteID == "US-15",
                                                         "deep",
                      ifelse(stratum == "None" & Lake_Name == "Charles Mill Lake" & siteID == "US-16",
                                                                "deep",
                      ifelse(stratum == "None" & Lake_Name == "Acton Lake" & siteID == "U-04",
                                                                       "deep",
                                                                       "shallow"))))))))

# Order Lake_Name to plot in ~ order of increasing TP
orderList <- order(tp.tn[, "TP"])
lakeLevels <- tp.tn[orderList, "Lake_Name"]
tp.tn$fLake_Name <- factor(tp.tn$Lake_Name, levels = lakeLevels)

# Highlight Cave Run Lake (lake of interest) data with color
plotColor <- ifelse(tp.tn$fLake_Name == "Michael J Kirwan Reservoir",
                    "red", "black")

ggplot(tp.tn,
       aes(TP, fLake_Name, color = plotColor)) +
  geom_point(aes(shape = d_s)) +
  xlab(expression(Total~Phosphorus~paste("(", {mu}, "g P ", L^{-1}, ")", sep = ""))) +  
  theme(axis.title.y = element_blank(), # Eliminate x-axis title
        plot.title = element_text(hjust = 0.5)) +  #plot title justify center
  ggtitle("Total Phosphorus") +
    theme(axis.text.y = element_text(color = c(rep("black", 7), "red", rep("black", 24)),
        face = c(rep("plain", 7), "bold", rep("plain", 24)))) +
  scale_color_manual(values = c("black", "red")) +
  guides(color=FALSE) +
  theme(legend.title = element_blank())
```

\newpage

```{r echo=FALSE, warning=FALSE, fig.width=7, fig.height=7, fig.cap='*TN concentrations at a deep and shallow site in each reservoir included in the study.  MJ Kirwan reservoir is highlighted in red.  See Fig. 1 for sample site locations.*'  }


# TN 
# Order Lake_Name to plot in ~ order of increasing TN
orderList <- order(tp.tn[, "TN"])
lakeLevels <- tp.tn[orderList, "Lake_Name"]
tp.tn$fLake_Name <- factor(tp.tn$Lake_Name, levels = lakeLevels)

ggplot(tp.tn,
       aes(TN, fLake_Name, color = plotColor)) +
  geom_point(aes(shape = d_s)) +
  xlab(expression(Total~Nitrogen~paste("(", {mu}, "g N ", L^{-1}, ")", sep = ""))) +   
   theme(axis.title.y = element_blank(), # Eliminate x-axis title
        plot.title = element_text(hjust = 0.5)) +  #plot title justify center
  ggtitle("Total Nitrogen") +
    theme(axis.text.y = element_text(color = c(rep("black", 1), "red", rep("black", 30)),
        face = c(rep("plain", 1), "bold", rep("plain", 30)))) +
  scale_color_manual(values = c("black", "red")) +
  guides(color=FALSE) +
  theme(legend.title = element_blank())



```

\newpage

\blandscape

## 5. Tables of measured values at each site  

Table 1: Surface (0.1 m) water quality parameters measured via sonde at each site on September 6^th^, 2016. "Site Depth" is the measure of how deep the lake was at each site. 

```{r warning=FALSE, echo=FALSE}
######################################################################
#### Item #5: Table of Water Quality Values by Site
## work in progress. Goal: produce a table for each lake with water quality and 
## GHG emissions info, including data that was not in the plots. Need to isolate
## the relevant data for each lake, rename the column headings, and add units

# dplyr package 
#"filter" command filters rows of interest. We're filtering the dataset for the 
# sampled sites at a given lake.
#"select" command selects the columns we want to show. The order they are listed 
#in the () is the order they will appear
#used info from http://j-wang.blogspot.com/2015/03/landscape-and-portrait-in-rmarkdown.html to orient table pages as landscape
mjKirwanTableSonde <- filter(eqAreaData, Lake_Name == "Michael J Kirwan Reservoir", 
                      EvalStatus == "sampled") %>%
                select(siteID, LatSamp, LongSmp, wtrDpth,  #site identification  
                chla_S, DO__L_S,  pH_S, SpCn__S, Tmp_C_S,  TrNTU_S) #shallow sonde

kable(mjKirwanTableSonde,
      align = "c",
      digits = c(1,5,5,1,1,1,1,0,1,1),
      col.names = c("Site ID", "Latitude", "Longitude", "Site Depth (m)",
                    "Chl a (ug/L)", "DO (mg/L)", "pH",
                    "Sp. Cond (uS/cm)", "Water Temp (C)", 
                    "Turbidity"))
```

Table 2: Surface (0.1 m) water chemistry parameters measured at one shallow and one deep site on September 6^th^, 2016. "Site Depth" is the measure of how deep the lake was at each site. 
```{r warning=FALSE, echo=FALSE} 
mjKirwanTableChem <- filter(eqAreaData, Lake_Name == "Michael J Kirwan Reservoir",
                      EvalStatus == "sampled")  %>%
                  filter(!is.na(TN)) %>%
                  select(siteID, LatSamp, LongSmp, wtrDpth,  #site identification  
                          TNH4, TNO2.3, TN, TRP, TP)  #nutrient data 
                
#order by site water depth
mjKirwanTableChemOrder <- plyr::arrange(mjKirwanTableChem, wtrDpth)
   
                         
kable(mjKirwanTableChemOrder,
      align = "c",
      digits = c(1,5,5,1,0,0,0,0,0),  #number of digits past decimal
      col.names = c("Site ID", "Latitude", "Longitude", "Site Depth (m)",
                    "NH4 (ugN/L)", "NO2.3 (ugN/L)", "Total N (ugN/L)", "Reactive P                       (ug/L)","Total P (ugP/L)" ))                          

```

\elandscape

## 6.  EPA disclaimer

The U.S. Environmental Protection Agency, through its Office of Research and Development, participated in the research described herein. It has been subjected to the Agency's administrative review and has been approved for limited external distribution. Any opinions expressed in this article are those of the authors and do not necessarily reflect the views of the Agency, therefore, no official endorsement should be inferred. Any mention of trade names or commercial products does not constitute endorsement or recommendation for use.
