# THIS SCRIPT WILL BE USED TO PLOT AND CLEAN LGR DATA IN PREPARATION
# FOR CALCULATION OF DIFFUSIVE EMISSION RATE

#1. INSPECT INSTANCES OF NA IN GGA
# Time/date stamp first
filter(gga, is.na(RDateTime))
# there are a bunch of NA for this field, likely related to corrupt LGR files.  Will just strip out for now.
gga <- filter(gga, !is.na(RDateTime))  # strip out missing RDateTime.  They complicate functions below.


#2.  LOOP TO ASSIGN LAKE NAME, SITEID, AND DEPLY TIME TO LGR OBSERVATIONS.
# Many rows in eqAreaData have NA for chmDeplyDtTm.  For example, at all oversample
# sites where chambers were not deployed.  We want to remove these rows, or the missing
# values complicate the loop.

missingChmDeplyDtTm <- is.na(eqAreaData$chmDeplyDtTm) # logical for missing chamber deployment times

for (i in 1:length(eqAreaData[!missingChmDeplyDtTm, "chmDeplyDtTm"])) {  # exclude rows with no deployment time
  chmDeplyDtTm.i <- eqAreaData[!missingChmDeplyDtTm, "chmDeplyDtTm"][i] # exclude rows with no deployment time, select ith observation
  Lake_Name.i <- eqAreaData[!missingChmDeplyDtTm, "Lake_Name"][i] # exclude rows with no deployment time, select ith observation
  siteID.i <- eqAreaData[!missingChmDeplyDtTm, "siteID"][i]  # exclude rows with no deployment time, select ith observation

  # Create logical indicator to indicate time window corresponding to
  # the ith lake and siteID.  Add 1 minute to deployment and retrieval time to expand
  # x-axis range during plotting.
  logicalIndicator.i <- gga$RDateTime > (chmDeplyDtTm.i - 60) & # 1 min < field notes
    gga$RDateTime < (chmDeplyDtTm.i + (6*60))# 6 min > field notes.  Retr time not recorded, assume 5 min after deployment

  gga[logicalIndicator.i, "Lake_Name"] = Lake_Name.i # Set Lake_Name
  gga[logicalIndicator.i, "siteID"] = siteID.i # Set siteID 
  gga[logicalIndicator.i, "co2DeplyDtTm"] = chmDeplyDtTm.i # Set chamber deployment time 
  gga[logicalIndicator.i, "co2RetDtTm"] = chmDeplyDtTm.i + (60*5) # Set chamber deployment time 
  gga[logicalIndicator.i, "ch4DeplyDtTm"] = chmDeplyDtTm.i # Set chamber deployment time 
  gga[logicalIndicator.i, "ch4RetDtTm"] = chmDeplyDtTm.i + (60*5) # Set chamber deployment time   
}

# POSIXct class was stripped during the loop.  Put it back in here.
gga[ , c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")] <- 
lapply(gga[ , c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")], 
       as.POSIXct, origin = "1970-01-01 00:00:00", tz= "UTC")  # set tz!

#3. RECORD ADJUSTMENTS TO TIME SERIES PLOTS
              # Lake_Name,       siteID,     co2DeplyDtTm,            co2RetDtTm,          ch4DeplyDtTm,        ch4RetDtTm
# This order is critical!
adjData <- c("Alum Creek Lake", "SU-02", "2016-06-07 15:10:05", "2016-06-07 15:17:00", "2016-06-07 15:10:05", "2016-06-07 15:17:00",
             "Alum Creek Lake", "SU-01", "2016-06-07 15:39:40", "2016-06-07 15:44:55", "2016-06-07 15:39:40", "2016-06-07 15:44:55",
             "Alum Creek Lake", "SU-05", "2016-06-07 16:01:40", "2016-06-07 16:04:00", "2016-06-07 16:01:40", "2016-06-07 16:04:00",
             "Alum Creek Lake", "SU-04", "2016-06-07 16:51:40", "2016-06-07 16:55:00", "2016-06-07 16:51:40", "2016-06-07 16:55:00",
             "Alum Creek Lake", "SU-06", "2016-06-07 17:08:30", "2016-06-07 17:12:00", "2016-06-07 17:08:30", "2016-06-07 17:12:00",
             "Alum Creek Lake", "SU-07", "2016-06-07 17:48:00", "2016-06-07 17:52:00", "2016-06-07 17:48:00", "2016-06-07 17:52:00",
             "Alum Creek Lake", "SU-34", "2016-06-07 14:05:30", "2016-06-07 14:09:00", "2016-06-07 14:05:30", "2016-06-07 14:09:00",
             "Alum Creek Lake", "SU-31", "2016-06-07 14:20:00", "2016-06-07 14:23:00", "2016-06-07 14:20:00", "2016-06-07 14:23:00",
             "Alum Creek Lake", "SU-35", "2016-06-07 14:32:05", "2016-06-07 14:35:00", "2016-06-07 14:32:05", "2016-06-07 14:35:00",
             "Alum Creek Lake", "SU-32", "2016-06-07 14:45:10", "2016-06-07 14:49:00", "2016-06-07 14:45:10", "2016-06-07 14:49:00",
             "Alum Creek Lake", "SU-29", "2016-06-07 15:00:00", "2016-06-07 15:03:00", "2016-06-07 15:00:00", "2016-06-07 15:03:00",
             "Delaware Reservoir", "S-30", "2016-06-08 13:41:00", "2016-06-08 13:46:00", "2016-06-08 13:40:30", "2016-06-08 13:44:00",
             "Delaware Reservoir", "S-32", "2016-06-08 14:06:30", "2016-06-08 14:08:00", "2016-06-08 14:06:30", "2016-06-08 14:08:00",   #after ebullition
             "Delaware Reservoir", "S-35", "2016-06-08 14:37:00", "2016-06-08 14:40:00", "2016-06-08 14:37:30", "2016-06-08 14:40:00",  #after ebullition
             "Delaware Reservoir", "S-33", "2016-06-08 15:04:00", "2016-06-08 15:08:00", "2016-06-08 15:04:00", "2016-06-08 15:08:00",
             "Delaware Reservoir", "S-29", "2016-06-08 15:19:00", "2016-06-08 15:22:00", "2016-06-08 15:19:00", "2016-06-08 15:22:00",
             "Delaware Reservoir", "S-34", "2016-06-08 15:30:00", "2016-06-08 15:34:00", "2016-06-08 15:30:00", "2016-06-08 15:34:00",
             "Delaware Reservoir", "S-05", "2016-06-08 15:42:15", "2016-06-08 15:46:00", "2016-06-08 15:42:15", "2016-06-08 15:46:00",
             "Delaware Reservoir", "S-29", "2016-06-08 15:54:00", "2016-06-08 15:56:00", "2016-06-08 15:53:00", "2016-06-08 15:53:50",
             "Delaware Reservoir", "S-07", "2016-06-08 16:13:00", "2016-06-08 16:17:00", "2016-06-08 16:13:00", "2016-06-08 16:17:00",
             "Delaware Reservoir", "S-03", "2016-06-08 16:37:00", "2016-06-08 16:41:00", "2016-06-08 16:37:00", "2016-06-08 16:41:00",
             "Delaware Reservoir", "S-06", "2016-06-08 16:52:00", "2016-06-08 16:55:00", "2016-06-08 16:52:00", "2016-06-08 16:55:00",
             "Delaware Reservoir", "S-04", "2016-06-08 17:22:00", "2016-06-08 17:25:00", "2016-06-08 17:22:00", "2016-06-08 17:25:00",
             "Delaware Reservoir", "S-08", "2016-06-08 17:46:00", "2016-06-08 17:50:00", "2016-06-08 17:41:30", "2016-06-08 17:44:30", #very high CH4, recheck
             "Knox Lake", "S-37", "2016-06-09 15:17:00", "2016-06-09 15:20:00", "2016-06-09 15:17:00", "2016-06-09 15:20:00",
             "Knox Lake", "S-31", "2016-06-09 15:40:00", "2016-06-09 15:43:00", "2016-06-09 15:40:00", "2016-06-09 15:43:00",
             "Knox Lake", "S-35", "2016-06-09 15:54:00", "2016-06-09 15:57:00", "2016-06-09 15:54:00", "2016-06-09 15:57:00",
             "Knox Lake", "S-32", "2016-06-09 16:02:00", "2016-06-09 16:06:00", "2016-06-09 16:02:00", "2016-06-09 16:02:40", #ebullition
             "Knox Lake", "S-07", "2016-06-09 16:20:00", "2016-06-09 16:24:00", "2016-06-09 16:20:00", "2016-06-09 16:24:00",
             "Knox Lake", "S-03", "2016-06-09 16:41:00", "2016-06-09 16:45:00", "2016-06-09 16:41:00", "2016-06-09 16:45:00",
             "Knox Lake", "S-03", "2016-06-09 16:41:00", "2016-06-09 16:45:00", "2016-06-09 16:41:00", "2016-06-09 16:45:00",
             "Knox Lake", "S-06", "2016-06-09 16:51:00", "2016-06-09 16:55:00", "2016-06-09 16:51:00", "2016-06-09 16:55:00",
             "Knox Lake", "S-10", "2016-06-09 17:01:00", "2016-06-09 17:03:00", "2016-06-09 17:01:00", "2016-06-09 17:03:00",
             "Knox Lake", "S-02", "2016-06-09 17:16:00", "2016-06-09 17:19:00", "2016-06-09 17:18:00", "2016-06-09 17:19:00", #ebullition
             "Knox Lake", "S-04", "2016-06-09 17:28:00", "2016-06-09 17:32:00", "2016-06-09 17:28:00", "2016-06-09 17:29:00", #ebullition
             "Knox Lake", "S-08", "2016-06-09 17:42:00", "2016-06-09 17:44:00", "2016-06-09 17:42:00", "2016-06-09 17:44:00", #ebullition
             "Knox Lake", "S-09", "2016-06-09 18:10:10", "2016-06-09 18:15:00", "2016-06-09 18:10:10", "2016-06-09 18:15:00",
             "Knox Lake", "S-05", "2016-06-09 18:22:00", "2016-06-09 18:27:00", "2016-06-09 18:22:00", "2016-06-09 18:24:30",
             "Knox Lake", "S-01", "2016-06-09 18:50:30", "2016-06-09 18:53:00", "2016-06-09 18:50:30", "2016-06-09 18:53:00", #eb
             "Kiser Lake", "U-12", "2016-06-13 12:40:00", "2016-06-13 12:45:00", "2016-06-13 12:38:00", "2016-06-13 12:44:00", #high CH4 -- 17 ppm
             "Kiser Lake", "U-08", "2016-06-13 12:57:30", "2016-06-13 13:01:00", "2016-06-13 12:57:30", "2016-06-13 13:01:00",
             "Kiser Lake", "U-15", "2016-06-13 13:12:00", "2016-06-13 13:16:00", "2016-06-13 13:13:20", "2016-06-13 13:15:00", #eb
             "Kiser Lake", "U-04", "2016-06-13 13:24:00", "2016-06-13 13:29:00", "2016-06-13 13:25:00", "2016-06-13 13:25:30", #eb
             "Kiser Lake", "U-11", "2016-06-13 13:37:00", "2016-06-13 13:41:00", "2016-06-13 13:37:00", "2016-06-13 13:39:30",
             "Kiser Lake", "U-07", "2016-06-13 13:54:00", "2016-06-13 13:57:00", "2016-06-13 13:53:00", "2016-06-13 13:57:30",
             "Kiser Lake", "U-13", "2016-06-13 14:11:00", "2016-06-13 14:15:00", "2016-06-13 14:11:00", "2016-06-13 14:15:00",
             "Kiser Lake", "U-09", "2016-06-13 14:23:30", "2016-06-13 14:26:00", "2016-06-13 14:23:00", "2016-06-13 14:26:00",
             "Kiser Lake", "U-05", "2016-06-13 14:34:00", "2016-06-13 14:37:00", "2016-06-13 14:34:00", "2016-06-13 14:35:00",
             "Kiser Lake", "U-14", "2016-06-13 14:51:00", "2016-06-13 14:54:00", "2016-06-13 14:50:50", "2016-06-13 14:51:40",
             "Kiser Lake", "U-03", "2016-06-13 15:03:30", "2016-06-13 15:06:00", "2016-06-13 15:03:00", "2016-06-13 15:06:00",
             "Kiser Lake", "U-10", "2016-06-13 15:16:30", "2016-06-13 15:18:00", "2016-06-13 15:16:30", "2016-06-13 15:18:00", # eb
             "Kiser Lake", "U-06", "2016-06-13 15:28:00", "2016-06-13 15:32:00", "2016-06-13 15:28:00", "2016-06-13 15:32:00",
             "Kiser Lake", "U-02", "2016-06-13 15:40:00", "2016-06-13 15:43:00", "2016-06-13 15:39:00", "2016-06-13 15:40:40",
             "Kiser Lake", "U-01", "2016-06-13 15:58:00", "2016-06-13 16:00:00", "2016-06-13 15:58:00", "2016-06-13 16:00:00",
             "Caesar Creek Lake", "SU-32", "2016-06-16 11:24:00", "2016-06-16 11:29:00", "2016-06-16 11:24:00", "2016-06-16 11:25:00",
             "Caesar Creek Lake", "SU-35", "2016-06-16 11:40:00", "2016-06-16 11:45:00", "2016-06-16 11:39:00", "2016-06-16 11:42:00",
             "Caesar Creek Lake", "SU-36", "2016-06-16 12:05:00", "2016-06-16 12:08:00", "2016-06-16 12:07:00", "2016-06-16 12:25:08",
             "Caesar Creek Lake", "SU-34", "2016-06-16 12:16:00", "2016-06-16 12:21:00", "2016-06-16 12:15:30", "2016-06-16 12:17:00",
             "Caesar Creek Lake", "SU-32", "2016-06-16 11:24:00", "2016-06-16 11:29:00", "2016-06-16 11:24:00", "2016-06-16 11:25:00", #eb
             "Caesar Creek Lake", "SU-33", "2016-06-16 12:29:00", "2016-06-16 12:34:00", "2016-06-16 12:28:00", "2016-06-16 12:29:40",
             "Caesar Creek Lake", "SU-09", "2016-06-16 13:36:00", "2016-06-16 13:40:00", "2016-06-16 13:36:00", "2016-06-16 13:40:00",
             "Caesar Creek Lake", "SU-03", "2016-06-16 13:47:30", "2016-06-16 13:52:00", "2016-06-16 13:47:00", "2016-06-16 13:52:00",
             "Caesar Creek Lake", "SU-07", "2016-06-16 14:09:00", "2016-06-16 14:14:00", "2016-06-16 14:09:00", "2016-06-16 14:14:00",
             "Caesar Creek Lake", "SU-05", "2016-06-16 14:28:00", "2016-06-16 14:32:00", "2016-06-16 14:28:00", "2016-06-16 14:32:00",
             "Caesar Creek Lake", "SU-08", "2016-06-16 14:51:00", "2016-06-16 14:56:00", "2016-06-16 14:51:00", "2016-06-16 14:56:00",
             "Caesar Creek Lake", "SU-04", "2016-06-16 15:00:00", "2016-06-16 15:25:00", "2016-06-16 15:00:00", "2016-06-16 15:25:00", #no clear gradient
             "Hocking County Lake", "US-07", "2016-06-20 13:06:00", "2016-06-20 13:11:00", "2016-06-20 13:06:00", "2016-06-20 13:08:00",  #lake number 6
             "Hocking County Lake", "US-19", "2016-06-20 14:47:00", "2016-06-20 14:52:00", "2016-06-20 14:47:00", "2016-06-20 14:51:00",
             "Hocking County Lake", "US-10", "2016-06-20 14:57:00", "2016-06-20 15:01:00", "2016-06-20 14:57:00", "2016-06-20 15:01:00",
             "Hocking County Lake", "US-06", "2016-06-20 15:09:00", "2016-06-20 15:13:00", "2016-06-20 15:09:00", "2016-06-20 15:13:00",
             "Hocking County Lake", "US-08", "2016-06-20 15:33:00", "2016-06-20 15:37:00", "2016-06-20 15:33:00", "2016-06-20 15:37:00",
             "Hocking County Lake", "US-20", "2016-06-20 15:55:00", "2016-06-20 15:59:00", "2016-06-20 15:55:00", "2016-06-20 15:59:00",
             "Burr Oak Reservoir", "S-21", "2016-06-21 13:46:00", "2016-06-21 13:50:00", "2016-06-21 13:46:00", "2016-06-21 13:50:00",    #lake number 7
             "Burr Oak Reservoir", "S-22", "2016-06-21 14:27:00", "2016-06-21 14:31:00", "2016-06-21 14:27:00", "2016-06-21 14:31:00",    
             "Burr Oak Reservoir", "S-20", "2016-06-21 14:39:00", "2016-06-21 14:43:00", "2016-06-21 14:39:00", "2016-06-21 14:43:00",    
             "Burr Oak Reservoir", "S-05", "2016-06-21 17:01:00", "2016-06-21 17:05:00", "2016-06-21 17:01:00", "2016-06-21 17:05:00",    
             "Burr Oak Reservoir", "S-07", "2016-06-21 17:32:00", "2016-06-21 17:37:00", "2016-06-21 17:32:00", "2016-06-21 17:33:30",    
             "Piedmont Lake", "SU-33", "2016-06-27 13:42:00", "2016-06-27 13:50:00", "2016-06-27 13:42:00", "2016-06-27 13:50:00",        # no clear gradient 
             "Piedmont Lake", "SU-36", "2016-06-27 14:05:00", "2016-06-27 14:10:00", "2016-06-27 14:05:00", "2016-06-27 14:10:00",        # lake number 8  
             "Piedmont Lake", "SU-39", "2016-06-27 14:16:00", "2016-06-27 14:20:00", "2016-06-27 14:16:00", "2016-06-27 14:20:00",
             "Piedmont Lake", "SU-32", "2016-06-27 14:27:00", "2016-06-27 14:32:00", "2016-06-27 14:27:00", "2016-06-27 14:32:00",
             "Piedmont Lake", "SU-35", "2016-06-27 14:39:00", "2016-06-27 14:44:00", "2016-06-27 14:39:00", "2016-06-27 14:44:00",
             "Piedmont Lake", "SU-09", "2016-06-27 14:51:00", "2016-06-27 14:57:00", "2016-06-27 14:51:00", "2016-06-27 14:57:00",
             "Piedmont Lake", "SU-06", "2016-06-27 15:04:00", "2016-06-27 15:09:00", "2016-06-27 15:04:00", "2016-06-27 15:09:00",
             "Piedmont Lake", "SU-02", "2016-06-27 15:19:00", "2016-06-27 15:24:00", "2016-06-27 15:19:00", "2016-06-27 15:24:00",
             "Piedmont Lake", "SU-01", "2016-06-27 15:38:00", "2016-06-27 15:42:00", "2016-06-27 15:37:00", "2016-06-27 15:42:00",
             "Piedmont Lake", "SU-05", "2016-06-27 16:06:00", "2016-06-27 16:10:00", "2016-06-27 16:06:00", "2016-06-27 16:10:00",
             "Piedmont Lake", "SU-04", "2016-06-27 16:23:00", "2016-06-27 16:28:00", "2016-06-27 16:23:00", "2016-06-27 16:28:00",
             "Piedmont Lake", "SU-08", "2016-06-27 16:40:00", "2016-06-27 16:45:00", "2016-06-27 16:40:00", "2016-06-27 16:45:00",
             "Piedmont Lake", "SU-03", "2016-06-27 16:56:00", "2016-06-27 17:00:00", "2016-06-27 16:56:00", "2016-06-27 17:00:00",
             "Piedmont Lake", "SU-07", "2016-06-27 17:07:00", "2016-06-27 17:11:00", "2016-06-27 17:07:00", "2016-06-27 17:11:00",
             "Piedmont Lake", "SU-10", "2016-06-27 17:32:30", "2016-06-27 17:37:00", "2016-06-27 17:32:30", "2016-06-27 17:37:00",
             "Tappan Lake", "SU-28", "2016-06-28 13:09:00", "2016-06-28 13:11:00", "2016-06-28 13:09:00", "2016-06-28 13:12:00",     #lake number 9
             "Tappan Lake", "SU-31", "2016-06-28 14:10:00", "2016-06-28 14:13:00", "2016-06-28 14:10:00", "2016-06-28 14:13:00",
             "Tappan Lake", "SU-30", "2016-06-28 14:18:00", "2016-06-28 14:22:00", "2016-06-28 14:18:00", "2016-06-28 14:22:00",
             "Tappan Lake", "SU-34", "2016-06-28 14:28:00", "2016-06-28 14:32:00", "2016-06-28 14:28:00", "2016-06-28 14:32:00",
             "Tappan Lake", "SU-35", "2016-06-28 14:44:00", "2016-06-28 14:47:00", "2016-06-28 14:44:00", "2016-06-28 14:47:00",
             "Tappan Lake", "SU-33", "2016-06-28 14:53:00", "2016-06-28 14:57:00", "2016-06-28 14:53:00", "2016-06-28 14:57:00",
             "Tappan Lake", "SU-05", "2016-06-28 15:18:00", "2016-06-28 15:23:00", "2016-06-28 15:18:00", "2016-06-28 15:23:00",
             "Tappan Lake", "SU-02", "2016-06-28 15:29:00", "2016-06-28 15:34:00", "2016-06-28 15:29:00", "2016-06-28 15:34:00",
             "Tappan Lake", "SU-01", "2016-06-28 15:51:00", "2016-06-28 15:55:00", "2016-06-28 15:51:00", "2016-06-28 15:55:00",
             "Tappan Lake", "SU-09", "2016-06-28 16:08:00", "2016-06-28 16:12:00", "2016-06-28 16:08:00", "2016-06-28 16:12:00",
             "Tappan Lake", "SU-06", "2016-06-28 16:21:00", "2016-06-28 16:25:00", "2016-06-28 16:21:00", "2016-06-28 16:25:00",
             "Tappan Lake", "SU-08", "2016-06-28 16:40:00", "2016-06-28 16:44:00", "2016-06-28 16:40:00", "2016-06-28 16:44:00",
             "Tappan Lake", "SU-03", "2016-06-28 17:00:00", "2016-06-28 17:04:00", "2016-06-28 17:00:00", "2016-06-28 17:04:00",
             "Tappan Lake", "SU-04", "2016-06-28 17:12:00", "2016-06-28 17:16:00", "2016-06-28 17:12:00", "2016-06-28 17:16:00",
             "Tappan Lake", "SU-07", "2016-06-28 17:38:00", "2016-06-28 17:42:00", "2016-06-28 17:38:00", "2016-06-28 17:42:00",
             "Atwood Lake", "SU-33", "2016-06-29 14:14:00", "2016-06-29 14:18:00", "2016-06-29 14:14:00", "2016-06-29 14:18:00",     # lake number 10
             "Atwood Lake", "SU-34", "2016-06-29 14:28:00", "2016-06-29 14:33:00", "2016-06-29 14:28:00", "2016-06-29 14:33:00",
             "Atwood Lake", "SU-36", "2016-06-29 14:50:00", "2016-06-29 14:54:00", "2016-06-29 14:50:00", "2016-06-29 14:54:00",
             "Atwood Lake", "SU-31", "2016-06-29 15:07:00", "2016-06-29 15:10:00", "2016-06-29 15:07:00", "2016-06-29 15:08:00", #eb
             "Atwood Lake", "SU-35", "2016-06-29 15:21:00", "2016-06-29 15:25:00", "2016-06-29 15:21:00", "2016-06-29 15:22:30", 
             "Atwood Lake", "SU-10", "2016-06-29 15:38:00", "2016-06-29 15:42:00", "2016-06-29 15:38:00", "2016-06-29 15:42:00", 
             "Atwood Lake", "SU-05", "2016-06-29 16:07:00", "2016-06-29 16:11:00", "2016-06-29 16:07:00", "2016-06-29 16:11:00", 
             "Atwood Lake", "SU-01", "2016-06-29 16:24:00", "2016-06-29 16:28:00", "2016-06-29 16:23:00", "2016-06-29 16:28:00", 
             "Atwood Lake", "SU-06", "2016-06-29 16:41:30", "2016-06-29 16:46:00", "2016-06-29 16:41:30", "2016-06-29 16:46:00", 
             "Atwood Lake", "SU-02", "2016-06-29 16:54:00", "2016-06-29 16:58:00", "2016-06-29 16:54:00", "2016-06-29 16:58:00", 
             "Atwood Lake", "SU-08", "2016-06-29 17:12:00", "2016-06-29 17:16:00", "2016-06-29 17:12:00", "2016-06-29 17:16:00", 
             "Atwood Lake", "SU-07", "2016-06-29 18:06:00", "2016-06-29 18:10:00", "2016-06-29 18:05:00", "2016-06-29 18:10:00", 
             "Rocky Fork Lake", "S-31", "2016-07-11 11:24:20", "2016-07-11 11:29:00", "2016-07-11 11:24:00", "2016-07-11 11:25:30", #lake number 11
             "Rocky Fork Lake", "S-33", "2016-07-11 11:50:00", "2016-07-11 11:55:00", "2016-07-11 11:50:00", "2016-07-11 11:55:00", 
             "Rocky Fork Lake", "S-32", "2016-07-11 12:22:00", "2016-07-11 12:27:00", "2016-07-11 12:22:00", "2016-07-11 12:27:00", 
             "Rocky Fork Lake", "S-35", "2016-07-11 12:40:00", "2016-07-11 12:44:00", "2016-07-11 12:40:00", "2016-07-11 12:42:30", 
             "Rocky Fork Lake", "S-34", "2016-07-11 12:57:00", "2016-07-11 13:01:00", "2016-07-11 12:56:00", "2016-07-11 13:01:00", 
             "Rocky Fork Lake", "S-04", "2016-07-11 13:12:00", "2016-07-11 13:16:00", "2016-07-11 13:11:00", "2016-07-11 13:12:20", 
             "Rocky Fork Lake", "S-01", "2016-07-11 13:33:00", "2016-07-11 13:35:00", "2016-07-11 13:32:30", "2016-07-11 13:34:30", #eb
             "Rocky Fork Lake", "S-05", "2016-07-11 13:46:00", "2016-07-11 13:50:00", "2016-07-11 13:46:00", "2016-07-11 13:49:00", 
             "Rocky Fork Lake", "S-09", "2016-07-11 14:03:00", "2016-07-11 14:07:00", "2016-07-11 14:03:00", "2016-07-11 14:07:00", 
             "Rocky Fork Lake", "S-06", "2016-07-11 14:15:00", "2016-07-11 14:19:00", "2016-07-11 14:15:00", "2016-07-11 14:19:00", 
             "Rocky Fork Lake", "S-06", "2016-07-11 14:15:00", "2016-07-11 14:19:00", "2016-07-11 14:15:00", "2016-07-11 14:19:00", 
             "Rocky Fork Lake", "S-02", "2016-07-11 14:26:00", "2016-07-11 14:30:00", "2016-07-11 14:26:00", "2016-07-11 14:30:00", 
             "Rocky Fork Lake", "S-10", "2016-07-11 14:40:00", "2016-07-11 14:44:00", "2016-07-11 14:40:00", "2016-07-11 14:44:00", 
             "Rocky Fork Lake", "S-08", "2016-07-11 14:56:00", "2016-07-11 15:00:00", "2016-07-11 14:56:00", "2016-07-11 15:00:00", 
             "Rocky Fork Lake", "S-03", "2016-07-11 15:15:00", "2016-07-11 15:19:00", "2016-07-11 15:15:00", "2016-07-11 15:19:00", 
             "Rocky Fork Lake", "S-07", "2016-07-11 15:53:00", "2016-07-11 15:57:00", "2016-07-11 15:53:00", "2016-07-11 15:57:00", 
             "Paint Creek Lake", "S-08", "2016-07-13 10:35:00", "2016-07-13 10:39:00", "2016-07-13 10:35:00", "2016-07-13 10:36:40",  #lake number 12 
             "Paint Creek Lake", "S-04", "2016-07-13 10:54:00", "2016-07-13 10:58:00", "2016-07-13 10:54:10", "2016-07-13 10:54:50",
             "Paint Creek Lake", "S-03", "2016-07-13 11:17:00", "2016-07-13 11:21:00", "2016-07-13 11:16:30", "2016-07-13 11:17:40",
             "Paint Creek Lake", "S-09", "2016-07-13 12:00:00", "2016-07-13 12:04:00", "2016-07-13 11:59:30", "2016-07-13 12:01:00",
             "Paint Creek Lake", "S-34", "2016-07-13 12:31:00", "2016-07-13 12:35:00", "2016-07-13 12:31:00", "2016-07-13 12:35:00",
             "Paint Creek Lake", "S-33", "2016-07-13 12:56:00", "2016-07-13 13:01:00", "2016-07-13 12:56:00", "2016-07-13 12:57:30",  #eb
             "Paint Creek Lake", "S-06", "2016-07-13 13:10:00", "2016-07-13 13:15:00", "2016-07-13 13:10:00", "2016-07-13 13:10:40",
             "Paint Creek Lake", "S-02", "2016-07-13 13:24:00", "2016-07-13 13:28:00", "2016-07-13 13:25:20", "2016-07-13 13:26:10",
             "Paint Creek Lake", "S-10", "2016-07-13 13:38:00", "2016-07-13 13:42:00", "2016-07-13 13:39:00", "2016-07-13 13:41:00",
             "Paint Creek Lake", "S-05", "2016-07-13 13:59:00", "2016-07-13 14:04:00", "2016-07-13 13:59:00", "2016-07-13 14:01:30",
             "Paint Creek Lake", "S-01", "2016-07-13 14:10:00", "2016-07-13 14:14:00", "2016-07-13 14:10:00", "2016-07-13 14:13:00",
             "Paint Creek Lake", "S-35", "2016-07-13 14:26:00", "2016-07-13 14:30:00", "2016-07-13 14:25:00", "2016-07-13 14:27:00",
             "Charles Mill Lake", "US-08", "2016-07-18 13:03:00", "2016-07-18 13:07:00", "2016-07-18 13:03:00", "2016-07-18 13:03:40", #eb
             "Charles Mill Lake", "US-12", "2016-07-18 13:20:00", "2016-07-18 13:25:00", "2016-07-18 13:20:00", "2016-07-18 13:25:00", #LAKE NUMBER 13
             "Charles Mill Lake", "US-07", "2016-07-18 13:40:00", "2016-07-18 13:45:00", "2016-07-18 13:40:00", "2016-07-18 13:45:00",
             "Charles Mill Lake", "US-04", "2016-07-18 13:53:00", "2016-07-18 13:58:00", "2016-07-18 13:53:00", "2016-07-18 13:58:00",
             "Charles Mill Lake", "US-15", "2016-07-18 14:05:00", "2016-07-18 14:10:00", "2016-07-18 14:05:00", "2016-07-18 14:10:00",
             "Charles Mill Lake", "US-05", "2016-07-18 14:17:00", "2016-07-18 14:21:00", "2016-07-18 14:17:00", "2016-07-18 14:21:00",
             "Charles Mill Lake", "US-01", "2016-07-18 14:41:00", "2016-07-18 14:46:00", "2016-07-18 14:41:00", "2016-07-18 14:46:00",
             "Charles Mill Lake", "US-02", "2016-07-18 15:00:00", "2016-07-18 15:05:00", "2016-07-18 15:00:00", "2016-07-18 15:04:00",
             "Charles Mill Lake", "US-17", "2016-07-18 16:20:00", "2016-07-18 16:23:00", "2016-07-18 16:20:00", "2016-07-18 16:22:30",
             "Charles Mill Lake", "US-16", "2016-07-18 16:40:00", "2016-07-18 16:44:00", "2016-07-18 16:40:00", "2016-07-18 16:44:00",
             "Charles Mill Lake", "US-11", "2016-07-18 16:55:00", "2016-07-18 16:59:00", "2016-07-18 16:54:30", "2016-07-18 16:55:20", #eb
             "Charles Mill Lake", "US-09", "2016-07-18 17:32:00", "2016-07-18 17:36:00", "2016-07-18 17:32:00", "2016-07-18 17:35:00",
             "Charles Mill Lake", "US-09", "2016-07-18 17:32:00", "2016-07-18 17:36:00", "2016-07-18 17:32:00", "2016-07-18 17:35:00",
             "Pleasant Hill Lake", "S-07", "2016-07-19 14:10:00", "2016-07-19 14:14:00", "2016-07-19 14:10:00", "2016-07-19 14:11:00", #LAKE NUMBER 14
             "Pleasant Hill Lake", "S-08", "2016-07-19 14:34:00", "2016-07-19 14:38:00", "2016-07-19 14:36:00", "2016-07-19 14:36:30", #eb
             "Pleasant Hill Lake", "S-03", "2016-07-19 14:46:00", "2016-07-19 14:50:00", "2016-07-19 14:46:00", "2016-07-19 14:47:00",
             "Pleasant Hill Lake", "S-02", "2016-07-19 14:56:00", "2016-07-19 15:00:00", "2016-07-19 14:58:00", "2016-07-19 15:01:00",
             "Pleasant Hill Lake", "S-31", "2016-07-19 15:40:00", "2016-07-19 15:44:00", "2016-07-19 15:39:30", "2016-07-19 15:40:30",
             "Pleasant Hill Lake", "S-33", "2016-07-19 16:11:00", "2016-07-19 16:14:00", "2016-07-19 16:10:30", "2016-07-19 16:14:00",
             "Pleasant Hill Lake", "S-34", "2016-07-19 16:31:00", "2016-07-19 16:35:00", "2016-07-19 16:30:30", "2016-07-19 16:33:00",
             "Pleasant Hill Lake", "S-06", "2016-07-19 16:43:30", "2016-07-19 16:48:00", "2016-07-19 16:44:00", "2016-07-19 16:48:00",
             "Apple Valley Lake", "S-35", "2016-07-20 13:55:00", "2016-07-20 13:58:00", "2016-07-20 13:55:00", "2016-07-20 13:56:00",   #LAKE NUMBER 15
             "Apple Valley Lake", "S-05", "2016-07-20 14:25:00", "2016-07-20 14:30:00", "2016-07-20 14:25:00", "2016-07-20 14:30:00",   
             "Apple Valley Lake", "S-01", "2016-07-20 14:34:00", "2016-07-20 14:38:00", "2016-07-20 14:34:00", "2016-07-20 14:38:00",   
             "Apple Valley Lake", "S-07", "2016-07-20 14:45:00", "2016-07-20 14:48:00", "2016-07-20 14:44:00", "2016-07-20 14:48:00",   
             "Apple Valley Lake", "S-03", "2016-07-20 14:58:00", "2016-07-20 15:02:00", "2016-07-20 14:58:00", "2016-07-20 15:01:30",   
             "Apple Valley Lake", "S-04", "2016-07-20 15:23:00", "2016-07-20 15:27:00", "2016-07-20 15:23:00", "2016-07-20 15:27:00",   
             "Apple Valley Lake", "S-31", "2016-07-20 17:47:00", "2016-07-20 17:52:00", "2016-07-20 17:47:00", "2016-07-20 17:48:00",   
             "Lake Waynoka", "SU-25", "2016-07-26 13:36:30", "2016-07-26 13:41:00", "2016-07-26 13:36:00", "2016-07-26 13:37:30",       #LAKE NUMBER 16    
             "Lake Waynoka", "SU-30", "2016-07-26 13:57:00", "2016-07-26 14:01:00", "2016-07-26 13:57:00", "2016-07-26 14:01:00",
             "Lake Waynoka", "SU-26", "2016-07-26 14:19:00", "2016-07-26 14:22:00", "2016-07-26 14:19:00", "2016-07-26 14:22:00",
             "William H Harsha Lake", "SU-06", "2016-08-01 11:03:00", "2016-08-01 11:07:00", "2016-08-01 11:03:00", "2016-08-01 11:07:00", #LAKE NUMBER 17
             "William H Harsha Lake", "SU-01", "2016-08-01 13:10:00", "2016-08-01 13:14:00", "2016-08-01 13:11:00", "2016-08-01 13:12:40",
             "William H Harsha Lake", "SU-09", "2016-08-01 13:42:00", "2016-08-01 13:46:00", "2016-08-01 13:42:00", "2016-08-01 13:43:00",
             "William H Harsha Lake", "SU-33", "2016-08-01 14:03:00", "2016-08-01 14:08:00", "2016-08-01 14:06:10", "2016-08-01 14:07:40",
             "William H Harsha Lake", "SU-31", "2016-08-01 14:26:30", "2016-08-01 14:29:00", "2016-08-01 14:27:00", "2016-08-01 14:29:00", #super weird -- CO2 ebullition
             "William H Harsha Lake", "SU-34", "2016-08-01 15:06:00", "2016-08-01 15:10:00", "2016-08-01 15:06:00", "2016-08-01 15:09:00",
             "William H Harsha Lake", "SU-08", "2016-08-01 16:24:00", "2016-08-01 16:29:00", "2016-08-01 16:24:00", "2016-08-01 16:25:30",
             "William H Harsha Lake", "SU-04", "2016-08-01 16:40:00", "2016-08-01 16:44:00", "2016-08-01 16:40:00", "2016-08-01 16:44:00",
             "Lake Loramie", "S-05", "2016-08-03 12:50:00", "2016-08-03 12:54:00", "2016-08-03 12:50:00", "2016-08-03 12:54:00",           #LAKE NUMBER 18
             "Lake Loramie", "S-01", "2016-08-03 13:15:00", "2016-08-03 13:19:00", "2016-08-03 13:16:00", "2016-08-03 13:19:00", 
             "Lake Loramie", "S-09", "2016-08-03 13:31:00", "2016-08-03 13:35:00", "2016-08-03 13:32:00", "2016-08-03 13:34:00", 
             "Lake Loramie", "S-04", "2016-08-03 13:51:00", "2016-08-03 13:57:00", "2016-08-03 13:51:00", "2016-08-03 13:52:00", 
             "Lake Loramie", "S-03", "2016-08-03 14:14:00", "2016-08-03 14:18:00", "2016-08-03 14:16:00", "2016-08-03 14:18:00", 
             "Lake Loramie", "S-06", "2016-08-03 14:52:00", "2016-08-03 14:56:00", "2016-08-03 14:52:00", "2016-08-03 14:54:00", 
             "Lake Loramie", "S-33", "2016-08-03 15:21:00", "2016-08-03 15:26:00", "2016-08-03 15:22:00", "2016-08-03 15:26:00", 
             "Lake Loramie", "S-10", "2016-08-03 16:51:00", "2016-08-03 16:55:00", "2016-08-03 16:51:00", "2016-08-03 16:54:00", 
             "Lake Loramie", "S-34", "2016-08-03 18:32:00", "2016-08-03 18:35:00", "2016-08-03 18:31:00", "2016-08-03 18:32:00", 
             "Lake Loramie", "S-35", "2016-08-03 18:52:00", "2016-08-03 18:57:00", "2016-08-03 18:55:00", "2016-08-03 18:58:00", 
             "Lake Loramie", "S-32", "2016-08-03 19:24:00", "2016-08-03 19:29:00", "2016-08-03 19:25:20", "2016-08-03 19:26:30", 
             "Lake Loramie", "S-31", "2016-08-03 19:41:00", "2016-08-03 19:45:00", "2016-08-03 19:41:00", "2016-08-03 19:44:00", 
             "Cave Run Lake", "SU-56", "2016-08-08 12:41:00", "2016-08-08 12:59:00", "2016-08-08 12:41:00", "2016-08-08 12:59:00", #Lake number 20, no clear diffusion, why are these all on the 8th?
             "Cave Run Lake", "SU-07", "2016-08-08 13:25:00", "2016-08-08 13:40:00", "2016-08-08 13:25:00", "2016-08-08 13:40:00",  #no clear diffusion
             "Cave Run Lake", "SU-51", "2016-08-08 13:41:00", "2016-08-08 13:59:00", "2016-08-08 13:41:00", "2016-08-08 13:59:00",  #no clear diffusion
             "Cave Run Lake", "SU-11", "2016-08-08 13:46:00", "2016-08-08 13:50:00", "2016-08-08 13:46:00", "2016-08-08 13:50:00",  #may have missed
             "Cave Run Lake", "SU-04", "2016-08-08 14:02:00", "2016-08-08 14:07:00", "2016-08-08 14:02:00", "2016-08-08 14:07:00",  #too early
             "Cave Run Lake", "SU-15", "2016-08-08 14:16:00", "2016-08-08 14:20:00", "2016-08-08 14:16:00", "2016-08-08 14:20:00",  #too early
             "Cave Run Lake", "SU-06", "2016-08-08 14:30:00", "2016-08-08 14:37:00", "2016-08-08 14:30:00", "2016-08-08 14:37:00",  #what?
             "Cave Run Lake", "SU-55", "2016-08-08 14:38:00", "2016-08-08 14:41:00", "2016-08-08 14:38:00", "2016-08-08 14:40:00",
             "Cave Run Lake", "SU-08", "2016-08-08 14:56:00", "2016-08-08 15:01:00", "2016-08-08 14:56:00", "2016-08-08 15:01:00",
             "Cave Run Lake", "SU-05", "2016-08-08 15:10:00", "2016-08-08 15:15:00", "2016-08-08 15:11:00", "2016-08-08 15:13:00",
             "Cave Run Lake", "SU-54", "2016-08-08 15:26:00", "2016-08-08 15:30:00", "2016-08-08 15:26:00", "2016-08-08 15:30:00",
             "Cave Run Lake", "SU-12", "2016-08-08 15:30:00", "2016-08-08 15:31:00", "2016-08-08 15:30:00", "2016-08-08 15:31:00",
             "Cave Run Lake", "SU-14", "2016-08-08 15:41:00", "2016-08-08 15:46:00", "2016-08-08 15:41:00", "2016-08-08 15:46:00",
             "Cave Run Lake", "SU-50", "2016-08-08 15:46:00", "2016-08-08 15:54:00", "2016-08-08 15:46:00", "2016-08-08 15:54:00", #missed?
             "Cave Run Lake", "SU-13", "2016-08-08 16:56:30", "2016-08-08 17:00:00", "2016-08-08 16:56:00", "2016-08-08 17:00:00", 
             "Cave Run Lake", "SU-46", "2016-08-08 17:03:00", "2016-08-08 17:10:00", "2016-08-08 17:03:00", "2016-08-08 17:10:00", #overlap with last site? 
             "Cave Run Lake", "SU-53", "2016-08-08 17:59:00", "2016-08-08 18:02:00", "2016-08-08 17:59:00", "2016-08-08 18:02:00",
             "Brookville Lake", "SU-08", "2016-08-18 11:42:00", "2016-08-18 11:46:00", "2016-08-18 11:42:00", "2016-08-18 11:46:00", #LAKE NUMBER 21, page 288
             "Brookville Lake", "SU-15", "2016-08-18 11:59:00", "2016-08-18 12:04:00", "2016-08-18 11:59:00", "2016-08-18 12:04:00",
             "Brookville Lake", "SU-04", "2016-08-18 12:10:00", "2016-08-18 12:14:00", "2016-08-18 12:10:00", "2016-08-18 12:14:00",
             "Brookville Lake", "SU-11", "2016-08-18 12:27:00", "2016-08-18 12:31:00", "2016-08-18 12:26:30", "2016-08-18 12:27:15", #eb
             "Brookville Lake", "SU-07", "2016-08-18 12:44:00", "2016-08-18 12:49:00", "2016-08-18 12:44:00", "2016-08-18 12:49:00",
             "Brookville Lake", "SU-03", "2016-08-18 13:12:00", "2016-08-18 13:17:00", "2016-08-18 13:13:30", "2016-08-18 13:15:00",
             "Brookville Lake", "SU-06", "2016-08-18 13:33:00", "2016-08-18 13:38:00", "2016-08-18 13:35:00", "2016-08-18 13:38:00",
             "Brookville Lake", "SU-01", "2016-08-18 13:43:00", "2016-08-18 13:47:00", "2016-08-18 13:43:00", "2016-08-18 13:44:30",
             "Brookville Lake", "SU-13", "2016-08-18 14:20:00", "2016-08-18 14:24:00", "2016-08-18 14:18:00", "2016-08-18 14:20:00",
             "Brookville Lake", "SU-12", "2016-08-18 14:49:00", "2016-08-18 14:52:00", "2016-08-18 14:48:00", "2016-08-18 14:49:30",
             "Brookville Lake", "SU-31", "2016-08-18 15:20:00", "2016-08-18 15:25:00", "2016-08-18 15:20:00", "2016-08-18 15:23:00",
             "Brookville Lake", "SU-35", "2016-08-18 15:29:00", "2016-08-18 15:33:00", "2016-08-18 15:29:00", "2016-08-18 15:30:00",
             "Brookville Lake", "SU-34", "2016-08-18 16:02:00", "2016-08-18 16:06:00", "2016-08-18 16:03:00", "2016-08-18 16:06:00",
             "Brookville Lake", "SU-32", "2016-08-18 16:10:00", "2016-08-18 16:20:00", "2016-08-18 16:10:00", "2016-08-18 16:20:00", #missed?
             "Carr Fork Lake", "SU-07", "2016-08-22 14:00:00", "2016-08-22 14:04:00", "2016-08-22 14:00:00", "2016-08-22 14:04:00",   #LAKE NUMBER 22; weird CO2 ebullition; prize for lake with best time recording
             "Buckhorn Lake", "SU-30", "2016-08-23 11:56:00", "2016-08-23 12:01:00", "2016-08-23 11:56:30", "2016-08-23 11:57:30",    #LAKE NUMBER 23
             "Buckhorn Lake", "SU-39", "2016-08-23 13:35:00", "2016-08-23 13:40:00", "2016-08-23 13:35:00", "2016-08-23 13:40:00",    
             "Buckhorn Lake", "SU-06", "2016-08-23 13:47:00", "2016-08-23 13:52:00", "2016-08-23 13:47:00", "2016-08-23 13:52:00",    
             "Buckhorn Lake", "SU-02", "2016-08-23 13:58:00", "2016-08-23 14:03:00", "2016-08-23 13:57:00", "2016-08-23 13:58:30",    
             "Buckhorn Lake", "SU-04", "2016-08-23 14:14:00", "2016-08-23 14:18:00", "2016-08-23 14:13:00", "2016-08-23 14:18:00",    
             "Buckhorn Lake", "SU-09", "2016-08-23 14:26:00", "2016-08-23 14:30:00", "2016-08-23 14:26:00", "2016-08-23 14:30:00",    
             "Buckhorn Lake", "SU-05", "2016-08-23 15:12:00", "2016-08-23 15:15:00", "2016-08-23 15:11:00", "2016-08-23 15:12:20",    
             "Buckhorn Lake", "SU-08", "2016-08-23 15:24:00", "2016-08-23 15:28:00", "2016-08-23 15:25:00", "2016-08-23 15:26:00",    
             "Buckhorn Lake", "SU-07", "2016-08-23 15:41:00", "2016-08-23 15:46:00", "2016-08-23 15:41:00", "2016-08-23 15:46:00",    
             "Buckhorn Lake", "SU-03", "2016-08-23 16:32:00", "2016-08-23 16:35:00", "2016-08-23 16:32:00", "2016-08-23 16:34:40",    
             "Lake Milton", "SU-31", "2016-08-30 13:56:00", "2016-08-30 14:01:00", "2016-08-30 13:58:00", "2016-08-30 14:00:00",    #LAKE NUMBER 24
             "Lake Milton", "SU-10", "2016-08-30 14:32:00", "2016-08-30 14:36:00", "2016-08-30 14:32:30", "2016-08-30 14:33:40",    
             "Lake Milton", "SU-09", "2016-08-30 14:40:00", "2016-08-30 14:45:00", "2016-08-30 14:40:30", "2016-08-30 14:43:40",    
             "Lake Milton", "SU-02", "2016-08-30 15:53:00", "2016-08-30 15:58:00", "2016-08-30 15:53:00", "2016-08-30 15:58:00",    
             "Lake Milton", "SU-07", "2016-08-30 16:20:00", "2016-08-30 16:25:00", "2016-08-30 16:19:00", "2016-08-30 16:21:00",    
             "Lake Milton", "SU-01", "2016-08-30 16:57:00", "2016-08-30 17:01:00", "2016-08-30 16:57:00", "2016-08-30 17:01:00",    
             "Lake Milton", "SU-08", "2016-08-30 17:08:00", "2016-08-30 17:13:00", "2016-08-30 17:08:30", "2016-08-30 17:11:00",    
             "Wingfoot Lake", "U-14", "2016-08-31 12:50:00", "2016-08-31 12:56:00", "2016-08-31 12:50:20", "2016-08-31 12:51:00", #LAKE NUMBER 25, page 352    
             "Wingfoot Lake", "U-04", "2016-08-31 12:59:00", "2016-08-31 13:04:00", "2016-08-31 12:59:10", "2016-08-31 12:59:40", #eb
             "Wingfoot Lake", "U-08", "2016-08-31 13:10:00", "2016-08-31 13:14:00", "2016-08-31 13:10:00", "2016-08-31 13:13:00",
             "Wingfoot Lake", "U-12", "2016-08-31 13:20:00", "2016-08-31 13:24:00", "2016-08-31 13:22:00", "2016-08-31 13:24:00",
             "Wingfoot Lake", "U-10", "2016-08-31 13:34:00", "2016-08-31 13:36:00", "2016-08-31 13:34:30", "2016-08-31 13:36:00",
             "Wingfoot Lake", "U-17", "2016-08-31 13:42:00", "2016-08-31 13:46:00", "2016-08-31 13:44:00", "2016-08-31 13:45:00", #eb
             "Wingfoot Lake", "U-19", "2016-08-31 13:55:00", "2016-08-31 14:00:00", "2016-08-31 13:55:30", "2016-08-31 13:56:30",
             "Wingfoot Lake", "U-07", "2016-08-31 14:38:00", "2016-08-31 14:42:00", "2016-08-31 14:37:40", "2016-08-31 14:38:20", #eb
             "Wingfoot Lake", "U-20", "2016-08-31 14:47:00", "2016-08-31 14:52:00", "2016-08-31 14:47:00", "2016-08-31 14:48:50", #crazy continuous eb, up to 350 ppm CH4
             "Wingfoot Lake", "U-06", "2016-08-31 14:55:00", "2016-08-31 15:00:00", "2016-08-31 14:58:00", "2016-08-31 14:59:00", #eb
             "Wingfoot Lake", "U-02", "2016-08-31 15:11:00", "2016-08-31 15:17:00", "2016-08-31 15:11:00", "2016-08-31 15:11:40",
             "Wingfoot Lake", "U-21", "2016-08-31 15:21:00", "2016-08-31 15:25:00", "2016-08-31 15:20:00", "2016-08-31 15:22:40",            
             "Lake Roaming Rock", "S-02", "2016-09-08 14:25:00", "2016-09-08 14:30:00", "2016-09-08 14:25:30", "2016-09-08 14:26:20",    #LAKE NUMBER 26, page 369
             "Lake Roaming Rock", "S-05", "2016-09-08 14:45:00", "2016-09-08 14:49:00", "2016-09-08 14:45:00", "2016-09-08 14:47:40",
             "Lake Roaming Rock", "S-07", "2016-09-08 15:05:00", "2016-09-08 15:10:00", "2016-09-08 15:05:00", "2016-09-08 15:06:30",
             "Lake Roaming Rock", "S-08", "2016-09-08 15:28:00", "2016-09-08 15:32:00", "2016-09-08 15:29:20", "2016-09-08 15:30:30",
             "Lake Roaming Rock", "S-34", "2016-09-08 17:04:00", "2016-09-08 17:08:00", "2016-09-08 17:05:00", "2016-09-08 17:06:00",
             "Lake Roaming Rock", "S-31", "2016-09-08 17:36:30", "2016-09-08 17:40:00", "2016-09-08 17:36:30", "2016-09-08 17:40:00",
             "Lake Roaming Rock", "S-32", "2016-09-08 17:48:00", "2016-09-08 17:53:00", "2016-09-08 17:47:50", "2016-09-08 17:48:40",
             "Senecaville Lake", "S-08", "2016-09-13 17:48:00", "2016-09-13 17:53:00", "2016-09-13 17:47:50", "2016-09-13 17:48:40",     #LAKE NUMBER 27, page 381
             "Senecaville Lake", "S-04", "2016-09-13 13:42:30", "2016-09-13 13:47:00", "2016-09-13 13:42:40", "2016-09-13 13:43:50",
             "Senecaville Lake", "S-05", "2016-09-13 13:58:00", "2016-09-13 14:03:00", "2016-09-13 13:58:00", "2016-09-13 14:00:30",
             "Senecaville Lake", "S-07", "2016-09-13 14:23:00", "2016-09-13 14:27:00", "2016-09-13 14:23:00", "2016-09-13 14:24:20",
             "Senecaville Lake", "S-03", "2016-09-13 14:34:00", "2016-09-13 14:39:00", "2016-09-13 14:34:00", "2016-09-13 14:36:00",
             "Senecaville Lake", "S-02", "2016-09-13 14:52:00", "2016-09-13 14:56:00", "2016-09-13 14:52:00", "2016-09-13 14:53:00",
             "Senecaville Lake", "S-06", "2016-09-13 15:05:00", "2016-09-13 15:10:00", "2016-09-13 15:05:00", "2016-09-13 15:10:00",
             "Senecaville Lake", "S-23", "2016-09-13 15:29:00", "2016-09-13 15:34:00", "2016-09-13 15:29:00", "2016-09-13 15:34:00",
             "Dillon Lake", "S-19", "2016-09-14 12:46:00", "2016-09-14 12:51:00", "2016-09-14 12:46:00", "2016-09-14 12:47:30",       #LAKE NUMBER 28, PAGE 396
             "Dillon Lake", "S-01", "2016-09-14 13:20:00", "2016-09-14 13:26:00", "2016-09-14 13:20:40", "2016-09-14 13:21:05", #EB
             "Dillon Lake", "S-15", "2016-09-14 13:32:00", "2016-09-14 13:41:00", "2016-09-14 13:32:00", "2016-09-14 13:41:00", #uptake at high ch4 concentration
             "Dillon Lake", "S-06", "2016-09-14 13:50:00", "2016-09-14 13:55:00", "2016-09-14 13:50:00", "2016-09-14 13:55:00",
             "Dillon Lake", "S-02", "2016-09-14 14:13:00", "2016-09-14 14:18:00", "2016-09-14 14:13:30", "2016-09-14 14:14:30",
             "Dillon Lake", "S-08", "2016-09-14 14:26:00", "2016-09-14 14:30:00", "2016-09-14 14:26:00", "2016-09-14 14:26:50",
             "Dillon Lake", "S-07", "2016-09-14 14:52:00", "2016-09-14 14:57:00", "2016-09-14 14:52:00", "2016-09-14 14:54:00",
             "Dillon Lake", "S-03", "2016-09-14 15:08:00", "2016-09-14 15:12:00", "2016-09-14 15:08:00", "2016-09-14 15:09:00",
             "Dillon Lake", "S-20", "2016-09-14 15:17:00", "2016-09-14 15:22:00", "2016-09-14 15:17:30", "2016-09-14 15:18:10",
             "Dillon Lake", "S-25", "2016-09-14 15:28:00", "2016-09-14 15:33:00", "2016-09-14 15:27:00", "2016-09-14 15:29:00", #EB
             "Dillon Lake", "S-24", "2016-09-14 15:42:00", "2016-09-14 15:47:00", "2016-09-14 15:42:30", "2016-09-14 15:44:40",
             "Dillon Lake", "S-22", "2016-09-14 16:20:00", "2016-09-14 16:23:00", "2016-09-14 16:19:30", "2016-09-14 16:21:20",
             "Dillon Lake", "S-27", "2016-09-14 16:54:00", "2016-09-14 16:58:00", "2016-09-14 16:53:40", "2016-09-14 16:54:40"       
             )

# Coerce to data.frame  
adjDataDf <- data.frame(Lake_Name = adjData[seq(1,length(adjData), 6)],
                             siteID = adjData[seq(2,length(adjData), 6)],
                             co2DeplyDtTm = adjData[seq(3,length(adjData), 6)],
                             co2RetDtTm = adjData[seq(4,length(adjData), 6)],
                             ch4DeplyDtTm = adjData[seq(5,length(adjData), 6)],
                             ch4RetDtTm = adjData[seq(6,length(adjData), 6)],
                        stringsAsFactors = FALSE)

# Convert date/time data from character to POSIXct
adjDataDf[, c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")] <- 
  lapply(adjDataDf[ , c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")], 
    as.POSIXct, format = "%Y-%m-%d %H:%M:%S", tz = "UTC")  # set tz!

#4. UPDATE DEPLOYMENT AND RETRIEVAL TIMES BASED ON FIXES ABOVE (SEE POINT 3)
  
  for (i in 1:with(adjDataDf, length(unique(paste(siteID, Lake_Name))))) { # for each unique site x lake combination
    lake.i <- adjDataDf$Lake_Name[i]  # extract ith lake
    site.i <- adjDataDf$siteID[i]  # extract ith site
    data.i <- adjDataDf[i, ]  # extract data.i
    
    #Calculate earliest and latest observation we need for this lake x site.  Simply min/max deply time.
    #This will make sure x-axis range is good for time series plots.
    #Use do.call the concentate "c" the df (which is actually a list) to a vector that
    #can be fed to min, while preserving the POSIXct attribute.
    #http://stackoverflow.com/questions/15659783/why-does-unlist-kill-dates-in-r
    #Unfortunately, this changes tz, which must be manually reset to UTC
    start.time.i <- min(do.call("c", data.i[, c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")]))
    end.time.i <- max(do.call("c", data.i[, c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")]))
    attr(start.time.i, "tzone") <- "UTC"  # reset time zone!
    attr(end.time.i, "tzone") <- "UTC"  # reset time zone!
    
    #Delete original CO2 and CH4 deployment / retrieval times from gga file.  These will be replaced with 
    #updated values.
    gga[gga$Lake_Name == lake.i &  !is.na(gga$Lake_Name) & gga$siteID == site.i & !is.na(gga$Lake_Name), 
        c("co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")] = NA
    
    #Logical indicator indicator block of gga data that should be updated
    #The extra minute and begining and end extend x-axis range for plotting,
    #which is good for picking time range for modeling diffusion.
    logicalIndicator.i <- gga$RDateTime > (start.time.i - 60) & # 1 min < deployment
      gga$RDateTime < (end.time.i + 60) # 1 min > retrieval
    
    # Replace original time stamps with updated numbers
    # POSIXct and time zone preserved through this step.  Wow!
    gga[logicalIndicator.i, c("Lake_Name", "siteID", "co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")] =
      data.i[, c("Lake_Name", "siteID", "co2DeplyDtTm", "co2RetDtTm", "ch4DeplyDtTm", "ch4RetDtTm")]
}




#5.  PLOT CO2 AND CH4 PROFILES FOR INSPECTION

pdf("ohio2016/output/figures/ggaProfile.pdf", paper = "a4r") # landscape orientation

for (i in 1:with(gga[!is.na(gga$Lake_Name), ], # this eliminates observations without a Lake_Name (LGR data when chamber not deployed)
                 length(unique(paste(siteID, Lake_Name))))) {  # each combination of site and lake
  
  site.lake.i <- with(gga[!is.na(gga$Lake_Name), ],  # extract unique lake x site combination
                      unique(paste(siteID, Lake_Name)))[i]
  site.i <- gsub(" .*$", "", site.lake.i)  # extract site.  regex allows for siteIDs of different lengths (i.e. S-01, SU-01)
  lake.i <- substr(site.lake.i, start = nchar(site.i) + 2, stop = nchar(site.lake.i)) # extract lake name
  data.i <- filter(gga, Lake_Name == lake.i, siteID == site.i) %>%  # Pull out GGA data chunk
    select(-GasT_C) # No need to plot gas temperature
  RDate.i <- unique(data.i$RDate)  # for panel title

  plot.i <- ggplot(data.i,  aes(x = RDateTime, y = CH4._ppm)) + 
          geom_point() +
          geom_vline(data = data.i, aes(xintercept = as.numeric(ch4DeplyDtTm))) +
          geom_vline(data = data.i, aes(xintercept = as.numeric(ch4RetDtTm))) +
          scale_x_datetime(labels=date_format("%H:%M")) +
          ggtitle(paste(lake.i, site.i, RDate.i)) +
          theme(axis.text.x = element_text(size = 7),
                plot.title = element_text(size = 11))
  
  plot.ii <- ggplot(data.i,  aes(x = RDateTime, y = CO2._ppm)) + 
          geom_point() +
          geom_vline(data = data.i, aes(xintercept = as.numeric(co2DeplyDtTm))) +
          geom_vline(data = data.i, aes(xintercept = as.numeric(co2RetDtTm))) +
          scale_x_datetime(labels=date_format("%H:%M")) +
          ggtitle(paste(lake.i, site.i)) +
          theme(axis.text.x = element_text(size = 7))
  
  grid.arrange(plot.i, plot.ii, ncol = 2) # use to put two plots per page
}
dev.off()  #6 min 50sec










